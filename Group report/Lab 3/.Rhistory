}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 1
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 10
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 4
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.1
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.01
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.001
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.00001
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.01
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 0.1
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- 1
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
c <- max(pdf_lap(data1[i,2]))
pdf_norm = function(x){
m <- 0
s <- 1
exp(-((x-m)**2)/(2*s**2))/(s*sqrt(2*pi))
}
pdf_lap = function(x){
m <- 0
b <- 1
exp(-abs(x-m)/b)/(2*b)
}
c <- max(pdf_lap(data1[i,2]))
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
exp(-(x**2)/2)/(sqrt(2*pi))
}
pdf_lap = function(x){
(1/2)*exp(-abs(x))
}
c <- sqrt(2/pi)*exp(0.5)
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
pdf_norm = function(x){
exp(-(x**2)/2)/(sqrt(2*pi))
}
pdf_lap = function(x){
(1/2)*exp(-abs(x))
}
c <- sqrt(2/pi)*exp(0.5)
n2 <- 2000
accept <- c()
for (i in 1:n) {
if(length(accept)>=n2){
break()
}
u <- data1[i,1]
Y <- data1[i,2]
q <- pdf_lap(Y)
p <- pdf_norm(Y)
if(u<=p/(c*q)){
accept <- c(accept,Y)
}
}
data2 <- data.frame(norm=accept)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
knitr::opts_chunk$set(echo = TRUE)
Sys.setlocale(locale="english")
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=20)+
geom_density(alpha=.2, fill="#FF6666")
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
xlim(c(-2,2))+
geom_density(alpha=.2, fill="#FF6666")
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white")+
xlim(c(-2,2))+
geom_density(alpha=.2, fill="#FF6666")
View(data2)
ggplot(data = data2, aes(x=norm)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")
data2
data2$real_norm <- rnorm(n=n2,0,1)
data2
reshape2::melt(data = data2, id=nrow(data2))
data2$id <- 1:2000
data2
reshape2::melt(data = data2, id=id)
reshape2::melt(data = data2, id.va=id)
?reshape2::melt
reshape2::melt(data = data2, value.name=id)
reshape2::melt(data = data2, id.vars=id)
head(data2)
data2 <- data.frame(norm=accept, id=1:2000)
data3 <- data.frame(real_norm=rnorm(n=n2,0,1),id = 1:2000)
data3 <- rbind(data2,data3)
data2 <- data.frame(val=accept, id=1:2000)
data3 <- data.frame(val=rnorm(n=n2,0,1),id = 1:2000)
data3 <- rbind(data2,data3)
data3
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_grid(~id)
ggplot(data = data3, aes(x=val)) +
geom_histogram()
ggplot(data = data3, aes(x=val)) +
geom_histogram()+
facet_grid(~id)
data2 <- data.frame(val=accept, id="esti")
data3 <- data.frame(val=rnorm(n=n2,0,1),id ="real")
data3 <- rbind(data2,data3)
ggplot(data = data3, aes(x=val)) +
geom_histogram()+
facet_grid(~id)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_grid(~id)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_wrap(~id)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_wrap(id~)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_wrap(~id.)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_wrap(id~.)
ggplot(data = data3, aes(x=val)) +
geom_histogram(aes(y=..density..),
colour="black",
fill="white",
bins=30)+
geom_density(alpha=.2, fill="#FF6666")+
facet_grid(id~.)

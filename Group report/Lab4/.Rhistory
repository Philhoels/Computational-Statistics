for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
head(mat_y)
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
mat_mu[2,]
mat_mu[t,]
rnorm(d,mat_mu[t,],0.2)
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], y = mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
re$
data_2_4 = cbind(1:d, re)
data_2_4 = cbind(X=1:d, re)
ggplot(data_2_4, ases(x=X,y=mu))+
geom_point()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_point()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
data_2_4 = cbind(X=X,Y=Y0, re)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y0))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y0))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], y = mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y0=Y, re)
nstep = 10
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1]),0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], y = mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
View(mat_mu)
View(mat_y)
data_2_4 = cbind(X=X,Y0=Y, re)
nstep = 10
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[d,], y = mat_y[d,])
}
re = gibbs(nstep, mu0, Y)
nstep = 10
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
data.frame(mu = mat_mu[nstep,], y = mat_y[nstep,])
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y0))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
re
View(data_2_4)
ggplot(data_2_4, aes(x=Y0,y=Y))+
geom_line()
nstep = 10
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
browser()
data.frame(mu = mat_mu[nstep,], y = mat_y[nstep,])
}
re = gibbs(nstep, mu0, Y)
View(mat_mu)
View(mat_y)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y0))+
geom_line()
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
nstep = 10
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
data.frame(mu=mat_mu[nstep,]  )
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_line()
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
data.frame(mu=mat_mu[nstep,]  )
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_line()
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
data.frame(mu=mat_mu[nstep,]  )
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y0=Y, re)
ggplot(data_2_4, aes(x=X,y=Y))+
geom_line()
ggplot(data_2_4, aes(x=X,y=mu))+
geom_line()
?reshape2::melt
data_2_4 = cbind(X=X,Y0=Y, re)
data_melt = reshape2::melt(data_2_4,value.name="X")
data_melt = reshape2::melt(data_2_4,value.name=X)
data_melt = reshape2::melt(data_2_4,id=X)
data_2_4 = cbind(X=X,Y0=Y, re)
View(data_2_4)
data_melt = reshape2::melt(data_2_4,id=X)
colnames(data_2_4)
data_2_4 = cbind(X=X,Y=Y, re)
data_melt = reshape2::melt(data_2_4,id.vars=X)
data_melt  <- reshape2::melt(data_2_4,id=X)
class(datta_2_4)
class(data_2_4)
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y=Y, re)
data_melt  <- reshape2::melt(data_2_4,id="X"")
data_melt  <- reshape2::melt(data_2_4,id="X")
View(data_melt)
ggplot(data_melt, aes(x=X,y=variable))+
geom_line()
data_2_4
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()
nstep = 100
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
data.frame(mu=mat_mu[nstep,]  )
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y=Y, re)
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
data.frame(mu=mat_mu  )
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y=Y, re[nstep,])
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
data_2_4 = cbind(X=X,Y=Y, re[,nstep])
data_melt  <- reshape2::melt(data_2_4,id="X")
data_2_4 = cbind(X=X,Y=Y, re[nstep,])
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
nstep = 1000
d = length(Y)
mu0 = rep(0,d)
gibbs = function(nstep, mu0, y0){
# browser()
d <- length(mu0)
mat_mu <- matrix(0, nrow=nstep, ncol=d)
mat_mu[1,] <- mu0
mat_y <- matrix(0, nrow=nstep, ncol=d)
mat_y[1,] <- y0
for (t in 2:nstep) {
mat_mu[t,1] = rnorm(1,mat_y[t-1,1],0.2)
for (i in 2:d) {
mat_mu[t,i] = rnorm(1,(mat_y[t-1,i]-mat_mu[t-1,i-1])/2,0.1)
}
mat_y[t,] = rnorm(d,mat_mu[t,],0.2)
}
# browser()
mat_mu
}
re = gibbs(nstep, mu0, Y)
data_2_4 = cbind(X=X,Y=Y, re[nstep,])
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
re[1000,]
data_2_4 = cbind(X=X,Y=Y, re[nstep,])
View(data_2_4)
data_2_4 = cbind(X=X,Y=Y, mu=re[nstep,])
data_melt  <- reshape2::melt(data_2_4,id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
View(data_melt)
View(data_2_4)
rm(data_melt)
data_melt  <- reshape2::melt(data_2_4, id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
View(data_2_4)
class(data_2_4)
data_2_4 = data.frame(cbind(X=X,Y=Y, mu=re[nstep,]))
data_melt  <- reshape2::melt(data_2_4, id="X")
ggplot(data_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
data_gribbs = data.frame(re)
colnames(data_gribbs)
data_gribbs = rbind(id=1:10 ,data.frame(re)[,1:10])
re_melt = reshape2::melt(data_gribbs, id = id)
data_gribbs = cbind(id=1:10 ,data.frame(t(re))[1:10,])
re_melt = reshape2::melt(data_gribbs, id = id)
colnames(data_gribbs)
re_melt = reshape2::melt(data_gribbs, id = "id")
ggplot(re_melt, aes(x=X,y=value,color=variable))+
geom_line()+
geom_point()
ggplot(re_melt, aes(x=id,y=value,color=variable))+
geom_line()+
geom_point()
id = 1:4
data_gribbs = cbind(id=id, data.frame(t(re))[id,500:1000])
re_melt = reshape2::melt(data_gribbs, id = "id")
ggplot(re_melt, aes(x=id,y=value,color=variable))+
geom_line()+
geom_point()
id = 1:4
data_gribbs = data.frame(re)[1:3,]
id = 1:4
data_gribbs = data.frame(re)[,id]
id = 1:4
data_gribbs = cbind(id,data.frame(t(re))[id,])
data_melt  <- reshape2::melt(data_melt, id="id")
data_gribbs$id
id = 1:4
data_gribbs = cbind(id,data.frame(t(re))[id,])
data_melt  <- reshape2::melt(data_melt, id="id")
class(data_gribbs)
id = 1:4
data_gribbs = cbind(id,data.frame(t(re))[id,1:100])
View(data_melt)
View(data_gribbs)
data_melt  <- reshape2::melt(data_melt, id="id")
data_melt  <- reshape2::melt(data_gribbs, id="id")
View(data_melt)
ggplot(data_melt, aes(x=id, y=value, color=variable)+
asds
)
ggplot(data_melt, aes(x=id, y=value, color=variable))+
geom_line()
id = 1:4
data_gribbs = cbind(id,data.frame(re)[id,1:100])
id = 1:4
data_gribbs = cbind(id,data.frame(re)[1:100,id])
data_gribbs = rbind(id,data.frame(re)[1:100,id])
View(data_gribbs)
data_gribbs = cbind(id=1:100,data.frame(re)[1:100,1:4])
data_melt  <- reshape2::melt(data_gribbs, id="id")
ggplot(data_melt, aes(x=id, y=value, color=variable))+
geom_line()
data_gribbs = cbind(id=1:1000,data.frame(re)[1:1000,1:4])
data_melt  <- reshape2::melt(data_gribbs, id="id")
ggplot(data_melt, aes(x=id, y=value, color=variable))+
geom_line()
data_gribbs = cbind(id=1:1000,data.frame(re)[1:1000,])
data_melt  <- reshape2::melt(data_gribbs, id="id")
ggplot(data_melt, aes(x=id, y=value, color=variable))+
geom_line()
data_gribbs = cbind(id=1:1000,data.frame(re)[,1:10])
data_melt  <- reshape2::melt(data_gribbs, id="id")
ggplot(data_melt, aes(x=id, y=value, color=variable))+
geom_line()
data_gribbs = cbind(nstep=1:1000,data.frame(re)[,1:10])
data_melt  <- reshape2::melt(data_gribbs, id="nstep")
ggplot(data_melt, aes(x=nstep, y=value, color=variable))+
geom_line()
data_gribbs = cbind(nstep=1:1000,data.frame(re)[,1:3])
data_melt  <- reshape2::melt(data_gribbs, id="nstep")
ggplot(data_melt, aes(x=nstep, y=value, color=variable))+
geom_line()
data_gribbs = cbind(nstep=1:1000,data.frame(re)[,1:2])
data_melt  <- reshape2::melt(data_gribbs, id="nstep")
ggplot(data_melt, aes(x=nstep, y=value, color=variable))+
geom_line()
data_gribbs = cbind(nstep=1:1000,data.frame(re))
data_melt  <- reshape2::melt(data_gribbs, id="nstep")
ggplot(data_melt, aes(x=nstep, y=value, color=variable))+
geom_line()
